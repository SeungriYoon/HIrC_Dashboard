<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°êµ¬ì„¼í„° ì¼ì • ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-active {
            background-color: white;
            color: #2563eb;
            border-bottom: 2px solid #2563eb;
        }
        .tab-inactive {
            color: #6b7280;
        }
        .tab-inactive:hover {
            color: #2563eb;
            background-color: #f9fafb;
        }
        .schedule-item {
            transition: all 0.2s ease;
        }
        .schedule-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-6xl mx-auto p-6 min-h-screen">
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <!-- í—¤ë” -->
            <div class="bg-blue-600 text-white p-6">
                <h1 class="text-3xl font-bold flex items-center gap-3">
                    ğŸ“‹ ì—°êµ¬ì„¼í„° ì¼ì • ê´€ë¦¬ ì‹œìŠ¤í…œ
                </h1>
                <p class="mt-2 text-blue-100">ì„¼í„°ì¥ ë° ë¶€ì„¼í„°ì¥ì˜ ì¼ì •ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì„¸ìš”</p>
            </div>

            <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="flex border-b bg-gray-100">
                <button onclick="showTab('input')" id="tab-input" class="flex items-center gap-2 px-6 py-4 font-medium transition-colors tab-active">
                    ğŸ“ ì¼ì • ì…ë ¥
                </button>
                <button onclick="showTab('query')" id="tab-query" class="flex items-center gap-2 px-6 py-4 font-medium transition-colors tab-inactive">
                    ğŸ” ì¼ì • ì¡°íšŒ
                </button>
                <button onclick="showTab('available')" id="tab-available" class="flex items-center gap-2 px-6 py-4 font-medium transition-colors tab-inactive">
                    â­ ê³µí†µ ê°€ëŠ¥ì‹œê°„
                </button>
                <button onclick="showTab('list')" id="tab-list" class="flex items-center gap-2 px-6 py-4 font-medium transition-colors tab-inactive">
                    ğŸ“‹ ì „ì²´ ì¼ì •
                </button>
            </div>

            <div class="p-6">
                <!-- ì¼ì • ì…ë ¥ íƒ­ -->
                <div id="content-input" class="tab-content">
                    <div class="space-y-6">
                        <div>
                            <h2 class="text-xl font-semibold mb-4 text-gray-800">ìì—°ì–´ ì¼ì • ì…ë ¥</h2>
                            <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                <h3 class="font-medium text-blue-800 mb-2">ì…ë ¥ ì˜ˆì‹œ:</h3>
                                <div class="text-sm text-blue-700 space-y-1">
                                    <p>â€¢ "ì„¼í„°ì¥ 12ì›” 25ì¼ ì˜¤í›„ 2ì‹œ íšŒì˜ì‹¤ì—ì„œ íšŒì˜"</p>
                                    <p>â€¢ "ë¶€ì„¼í„°ì¥ 1ì›” 3ì¼ 10:30 ì—°êµ¬ì‹¤ì—ì„œ ì‹¤í—˜"</p>
                                    <p>â€¢ "ì„¼í„°ì¥ 2ì›” 14ì¼ 3ì‹œê°„ ì¼ì • (ì¤‘ìš” íšŒì˜)"</p>
                                    <p>â€¢ "ë¶€ì„¼í„°ì¥ 3ì›” 1ì¼ 14:00-17:00 ì„¸ë¯¸ë‚˜ì‹¤"</p>
                                </div>
                            </div>
                            <textarea
                                id="inputText"
                                placeholder="ì¼ì •ì„ ìì—°ì–´ë¡œ ì…ë ¥í•˜ì„¸ìš”... (ì˜ˆ: ì„¼í„°ì¥ 12ì›” 25ì¼ 3ì‹œê°„ ì¼ì • íšŒì˜ì‹¤ì—ì„œ ì¤‘ìš” íšŒì˜)"
                                class="w-full h-32 p-4 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            ></textarea>
                            <div class="mt-4 flex gap-2">
                                <button
                                    onclick="addSchedule()"
                                    class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
                                >
                                    â• ì¼ì • ì¶”ê°€
                                </button>
                                <button
                                    onclick="clearInput()"
                                    class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors flex items-center gap-2"
                                >
                                    ğŸ—‘ï¸ ì§€ìš°ê¸°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì¼ì • ì¡°íšŒ íƒ­ -->
                <div id="content-query" class="tab-content hidden">
                    <div class="space-y-6">
                        <div>
                            <h2 class="text-xl font-semibold mb-4 text-gray-800">ì¼ì • ì¡°íšŒ</h2>
                            <div class="flex gap-4 mb-4">
                                <input
                                    type="text"
                                    id="queryText"
                                    placeholder="ì¡°íšŒí•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì„¼í„°ì¥ë‹˜ ì¼ì •)"
                                    class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                />
                                <button
                                    onclick="querySchedule()"
                                    class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2"
                                >
                                    ğŸ” ê²€ìƒ‰
                                </button>
                            </div>
                            <div id="queryResult" class="bg-gray-50 p-4 rounded-lg hidden">
                                <h3 class="font-medium mb-2 text-gray-800">ì¡°íšŒ ê²°ê³¼:</h3>
                                <div id="queryResultText" class="text-sm text-gray-700"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ê³µí†µ ê°€ëŠ¥ì‹œê°„ íƒ­ -->
                <div id="content-available" class="tab-content hidden">
                    <div class="space-y-6">
                        <h2 class="text-xl font-semibold mb-4 text-gray-800">ì„¼í„°ì¥ & ë¶€ì„¼í„°ì¥ ê³µí†µ ê°€ëŠ¥ì‹œê°„</h2>
                        <div class="bg-green-50 p-6 rounded-lg">
                            <h3 class="font-medium mb-4 text-green-800 flex items-center gap-2">
                                â­ ë‘ ë¶„ ëª¨ë‘ ê°€ëŠ¥í•œ ë‚ ì§œ (í–¥í›„ 30ì¼)
                            </h3>
                            <div id="availableDates" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                <!-- ê°€ëŠ¥í•œ ë‚ ì§œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì „ì²´ ì¼ì • íƒ­ -->
                <div id="content-list" class="tab-content hidden">
                    <div class="space-y-6">
                        <div class="flex justify-between items-center">
                            <h2 class="text-xl font-semibold text-gray-800">ì „ì²´ ì¼ì • ëª©ë¡</h2>
                            <div class="flex gap-2">
                                <button
                                    onclick="downloadCSV()"
                                    class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2"
                                >
                                    ğŸ“¥ CSV ë‹¤ìš´ë¡œë“œ
                                </button>
                                <button
                                    onclick="clearAllSchedules()"
                                    class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2"
                                >
                                    ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ
                                </button>
                            </div>
                        </div>
                        
                        <div id="scheduleTable" class="overflow-x-auto">
                            <!-- ì¼ì • í…Œì´ë¸”ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let schedules = [];
        let activeTab = 'input';

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì¼ì • ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSchedules() {
            const saved = localStorage.getItem('researchCenterSchedules');
            if (saved) {
                schedules = JSON.parse(saved);
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì¼ì • ì €ì¥
        function saveSchedules() {
            localStorage.setItem('researchCenterSchedules', JSON.stringify(schedules));
        }

        // íƒ­ ì „í™˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.add('hidden'));

            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            const tabs = document.querySelectorAll('[id^="tab-"]');
            tabs.forEach(tab => {
                tab.className = tab.className.replace('tab-active', 'tab-inactive');
            });

            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.getElementById('content-' + tabName).classList.remove('hidden');
            const activeTabElement = document.getElementById('tab-' + tabName);
            activeTabElement.className = activeTabElement.className.replace('tab-inactive', 'tab-active');
            
            activeTab = tabName;

            // í•„ìš”í•œ ê²½ìš° ë°ì´í„° ì—…ë°ì´íŠ¸
            if (tabName === 'available') {
                updateAvailableDates();
            } else if (tabName === 'list') {
                updateScheduleTable();
            }
        }

        // ì…ë ¥ì°½ ì§€ìš°ê¸°
        function clearInput() {
            document.getElementById('inputText').value = '';
        }

        // ìì—°ì–´ ì¼ì • íŒŒì‹± (ê°œì„ ëœ ë²„ì „)
        function parseScheduleInput(text) {
            const results = [];
            
            // ì„¼í„°ì¥/ë¶€ì„¼í„°ì¥ ì‹ë³„
            const personRegex = /(ì„¼í„°ì¥|ë¶€ì„¼í„°ì¥)/g;
            const personMatches = [];
            let personMatch;
            
            while ((personMatch = personRegex.exec(text)) !== null) {
                personMatches.push({
                    person: personMatch[1],
                    index: personMatch.index
                });
            }
            
            if (personMatches.length === 0) {
                return { success: false, error: 'ì„¼í„°ì¥ ë˜ëŠ” ë¶€ì„¼í„°ì¥ì„ ëª…ì‹œí•´ì£¼ì„¸ìš”.' };
            }

            for (let p = 0; p < personMatches.length; p++) {
                const person = personMatches[p].person;
                const startIndex = personMatches[p].index;
                
                // í•´ë‹¹ ì‚¬ëŒì˜ ì¼ì • ë¶€ë¶„ ì¶”ì¶œ
                let scheduleText = text.substring(startIndex);
                if (p + 1 < personMatches.length) {
                    scheduleText = text.substring(startIndex, personMatches[p + 1].index);
                }

                const dates = [];
                const times = [];
                const locations = [];
                const notes = [];

                // ë‚ ì§œ ì¶”ì¶œ (ê°œì„ ëœ ì •ê·œì‹)
                const dateRegex = /(\d{1,2})ì›”\s*(\d{1,2})ì¼/g;
                let dateMatch;
                while ((dateMatch = dateRegex.exec(scheduleText)) !== null) {
                    dates.push(dateMatch[1] + 'ì›” ' + dateMatch[2] + 'ì¼');
                }

                // ì‹œê°„ ì¶”ì¶œ (ê°œì„ ëœ ì •ê·œì‹ë“¤)
                let timeMatch;
                
                // ì‹œê°„ëŒ€ í˜•ì‹ (14:00-17:00)
                const timeRangeRegex = /(\d{1,2}):(\d{2})\s*-\s*(\d{1,2}):(\d{2})/g;
                while ((timeMatch = timeRangeRegex.exec(scheduleText)) !== null) {
                    times.push(timeMatch[1] + ':' + timeMatch[2] + '-' + timeMatch[3] + ':' + timeMatch[4]);
                }
                
                // Xì‹œê°„ ì¼ì •
                const hourRegex = /(\d{1,2})ì‹œê°„\s*ì¼ì •/g;
                while ((timeMatch = hourRegex.exec(scheduleText)) !== null) {
                    const duration = parseInt(timeMatch[1]);
                    const startHour = 14;
                    const endHour = startHour + duration;
                    times.push(startHour + ':00-' + endHour + ':00');
                    notes.push(duration + 'ì‹œê°„ ì†Œìš” ì˜ˆì •');
                }
                
                // ì¼ë°˜ ì‹œê°„ (ì´ë¯¸ ì‹œê°„ëŒ€ê°€ ì—†ì„ ë•Œë§Œ)
                if (times.length === 0) {
                    const normalTimeRegex = /(\d{1,2}):(\d{2})/g;
                    while ((timeMatch = normalTimeRegex.exec(scheduleText)) !== null) {
                        times.push(timeMatch[1] + ':' + timeMatch[2]);
                    }
                }
                
                // ì˜¤ì „/ì˜¤í›„ (ì´ë¯¸ ì‹œê°„ì´ ì—†ì„ ë•Œë§Œ)
                if (times.length === 0) {
                    const ampmRegex = /(ì˜¤ì „|ì˜¤í›„)\s*(\d{1,2}):?(\d{2})?/g;
                    while ((timeMatch = ampmRegex.exec(scheduleText)) !== null) {
                        const hour = timeMatch[2];
                        const minute = timeMatch[3] || '00';
                        times.push(timeMatch[1] + ' ' + hour + ':' + minute);
                    }
                }

                // ì¥ì†Œ ì¶”ì¶œ (ê°œì„ ëœ ì •ê·œì‹)
                const locationRegex = /([^\n]*(?:ì‹¤|ê´€|ì„¼í„°|íšŒì˜ì‹¤|ì‚¬ë¬´ì‹¤|ì—°êµ¬ì‹¤|ì„¸ë¯¸ë‚˜ì‹¤))/g;
                let locationMatch;
                while ((locationMatch = locationRegex.exec(scheduleText)) !== null) {
                    const location = locationMatch[1].trim();
                    if (location && locations.indexOf(location) === -1) {
                        locations.push(location);
                    }
                }

                // ë¹„ê³  ì‚¬í•­ ì¶”ì¶œ
                const noteKeywords = ['íšŒì˜', 'ë¯¸íŒ…', 'ì‹¤í—˜', 'ì„¸ë¯¸ë‚˜', 'ë°œí‘œ', 'êµìœ¡', 'ë©´ë‹´', 'ê²€í† ', 'ë…¼ì˜', 'í˜‘ì˜', 'ì¤‘ìš”'];
                for (const keyword of noteKeywords) {
                    if (scheduleText.indexOf(keyword) !== -1) {
                        const found = notes.some(note => note.indexOf(keyword) !== -1);
                        if (!found) {
                            notes.push(keyword);
                        }
                    }
                }

                // ê´„í˜¸ ì•ˆì˜ ë‚´ìš©
                const parenthesesRegex = /\(([^)]+)\)/g;
                let parenthesesMatch;
                while ((parenthesesMatch = parenthesesRegex.exec(scheduleText)) !== null) {
                    const note = parenthesesMatch[1].trim();
                    if (notes.indexOf(note) === -1) {
                        notes.push(note);
                    }
                }

                // ê²°ê³¼ ì¡°í•©
                if (dates.length > 0) {
                    for (let d = 0; d < dates.length; d++) {
                        const timeValue = times[d] || times[0] || 'ì‹œê°„ ë¯¸ì •';
                        
                        results.push({
                            person: person,
                            date: dates[d],
                            time: timeValue,
                            location: locations[d] || locations[0] || 'ì¥ì†Œ ë¯¸ì •',
                            notes: notes.join(', ') || '',
                            id: Date.now() + Math.random()
                        });
                    }
                } else {
                    // ë‚ ì§œê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í•­ëª© ìƒì„±
                    const timeValue = times[0] || 'ì‹œê°„ ë¯¸ì •';
                    
                    results.push({
                        person: person,
                        date: 'ë‚ ì§œ ë¯¸ì •',
                        time: timeValue,
                        location: locations[0] || 'ì¥ì†Œ ë¯¸ì •',
                        notes: notes.join(', ') || '',
                        id: Date.now() + Math.random()
                    });
                }
            }

            return { success: true, schedules: results };
        }

        // ì¼ì • ì¶”ê°€
        function addSchedule() {
            const inputText = document.getElementById('inputText').value.trim();
            if (!inputText) {
                alert('ì¼ì •ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const parseResult = parseScheduleInput(inputText);
            
            if (parseResult.success) {
                for (const schedule of parseResult.schedules) {
                    schedules.push(schedule);
                }
                document.getElementById('inputText').value = '';
                saveSchedules();
                alert('ì¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } else {
                alert(parseResult.error);
            }
        }

        // ì¼ì • ì¡°íšŒ (ê°œì„ ëœ ë²„ì „)
        function querySchedule() {
            const queryText = document.getElementById('queryText').value.trim().toLowerCase();
            if (!queryText) {
                alert('ì¡°íšŒí•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            let results = [];

            if (queryText.indexOf('ì„¼í„°ì¥') !== -1) {
                results = schedules.filter(schedule => schedule.person === 'ì„¼í„°ì¥');
            } else if (queryText.indexOf('ë¶€ì„¼í„°ì¥') !== -1) {
                results = schedules.filter(schedule => schedule.person === 'ë¶€ì„¼í„°ì¥');
            } else {
                results = schedules.filter(schedule => 
                    schedule.person.toLowerCase().includes(queryText) ||
                    schedule.date.toLowerCase().includes(queryText) ||
                    schedule.location.toLowerCase().includes(queryText) ||
                    schedule.notes.toLowerCase().includes(queryText)
                );
            }

            const queryResultDiv = document.getElementById('queryResult');
            const queryResultText = document.getElementById('queryResultText');

            if (results.length === 0) {
                queryResultText.innerHTML = '<p class="text-gray-500">í•´ë‹¹í•˜ëŠ” ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            } else {
                let resultHTML = '<div class="space-y-2">';
                for (const schedule of results) {
                    const personClass = schedule.person === 'ì„¼í„°ì¥' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800';
                    resultHTML += `
                        <div class="p-3 bg-white rounded border schedule-item">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="px-2 py-1 rounded-full text-sm font-medium ${personClass}">${schedule.person}</span>
                                <span class="text-sm text-gray-600">${schedule.date} ${schedule.time}</span>
                            </div>
                            <div class="text-sm text-gray-700">ğŸ“ ${schedule.location}</div>
                            ${schedule.notes ? `<div class="text-xs text-gray-500 mt-1">ğŸ“ ${schedule.notes}</div>` : ''}
                        </div>
                    `;
                }
                resultHTML += '</div>';
                queryResultText.innerHTML = resultHTML;
            }

            queryResultDiv.classList.remove('hidden');
        }

        // ê³µí†µ ê°€ëŠ¥ì‹œê°„ ì—…ë°ì´íŠ¸ (ê°œì„ ëœ ë²„ì „)
        function updateAvailableDates() {
            const directorSchedules = schedules.filter(s => s.person === 'ì„¼í„°ì¥');
            const viceDirectorSchedules = schedules.filter(s => s.person === 'ë¶€ì„¼í„°ì¥');
            
            // ëª¨ë“  ì˜ˆì•½ëœ ë‚ ì§œ ìˆ˜ì§‘
            const allBusyDates = [
                ...directorSchedules.map(s => s.date),
                ...viceDirectorSchedules.map(s => s.date)
            ];

            // í–¥í›„ 30ì¼ ì¤‘ ì‚¬ìš© ê°€ëŠ¥í•œ ë‚ ì§œ ì°¾ê¸°
            const availableDates = [];
            const today = new Date();
            
            for (let i = 0; i < 30; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                const dateString = (date.getMonth() + 1) + 'ì›” ' + date.getDate() + 'ì¼';
                
                const isBusy = allBusyDates.some(busyDate => 
                    busyDate === dateString || busyDate === 'ë‚ ì§œ ë¯¸ì •'
                );
                
                if (!isBusy) {
                    availableDates.push(dateString);
                }
            }

            const availableDatesDiv = document.getElementById('availableDates');
            
            if (availableDates.length > 0) {
                let html = '';
                for (let i = 0; i < Math.min(availableDates.length, 12); i++) {
                    html += `<div class="bg-white p-3 rounded border text-center text-green-700 font-medium hover:bg-green-50 transition-colors">${availableDates[i]}</div>`;
                }
                availableDatesDiv.innerHTML = html;
            } else {
                availableDatesDiv.innerHTML = '<p class="text-green-700">í˜„ì¬ ê³µí†µ ê°€ëŠ¥í•œ ë‚ ì§œê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ì¼ì • í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ê°œì„ ëœ ë²„ì „)
        function updateScheduleTable() {
            const scheduleTableDiv = document.getElementById('scheduleTable');
            
            if (schedules.length > 0) {
                let tableHTML = `
                    <table class="w-full border-collapse bg-white rounded-lg overflow-hidden shadow">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ë‹´ë‹¹ì</th>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ë‚ ì§œ</th>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ì‹œê°„</th>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ì¥ì†Œ</th>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ë¹„ê³ </th>
                                <th class="border border-gray-300 px-4 py-3 text-left font-medium text-gray-700">ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                for (let i = 0; i < schedules.length; i++) {
                    const schedule = schedules[i];
                    const rowClass = i % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                    const personClass = schedule.person === 'ì„¼í„°ì¥' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800';
                    
                    tableHTML += `
                        <tr class="${rowClass} schedule-item">
                            <td class="border border-gray-300 px-4 py-3">
                                <span class="px-2 py-1 rounded-full text-sm font-medium ${personClass}">${schedule.person}</span>
                            </td>
                            <td class="border border-gray-300 px-4 py-3">${schedule.date}</td>
                            <td class="border border-gray-300 px-4 py-3">${schedule.time}</td>
                            <td class="border border-gray-300 px-4 py-3">${schedule.location}</td>
                            <td class="border border-gray-300 px-4 py-3 text-sm text-gray-600">${schedule.notes || '-'}</td>
                            <td class="border border-gray-300 px-4 py-3">
                                                                 <button onclick="deleteSchedule(${i})" class="text-red-600 hover:text-red-800 text-sm">ğŸ—‘ï¸ ì‚­ì œ</button>
                            </td>
                        </tr>
                    `;
                }
                
                tableHTML += '</tbody></table>';
                scheduleTableDiv.innerHTML = tableHTML;
            } else {
                scheduleTableDiv.innerHTML = `
                    <div class="text-center py-12 bg-gray-50 rounded-lg">
                        <div class="text-6xl mb-4">ğŸ“…</div>
                        <p class="text-gray-500 text-lg">ì•„ì§ ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                        <p class="text-gray-400">ì¼ì • ì…ë ¥ íƒ­ì—ì„œ ìƒˆë¡œìš´ ì¼ì •ì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
                    </div>
                `;
            }
        }

        // ì¼ì • ì‚­ì œ
        function deleteSchedule(index) {
            if (confirm('ì´ ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                schedules.splice(index, 1);
                saveSchedules();
                updateScheduleTable();
            }
        }

        // ì „ì²´ ì¼ì • ì‚­ì œ
        function clearAllSchedules() {
            if (confirm('ëª¨ë“  ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                schedules = [];
                saveSchedules();
                updateScheduleTable();
                alert('ëª¨ë“  ì¼ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // CSV ë‹¤ìš´ë¡œë“œ (ê°œì„ ëœ ë²„ì „)
        function downloadCSV() {
            if (schedules.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const csvRows = ['ë‹´ë‹¹ì,ë‚ ì§œ,ì‹œê°„,ì¥ì†Œ,ë¹„ê³ '];
            
            for (const schedule of schedules) {
                const row = [
                    schedule.person,
                    schedule.date,
                    schedule.time,
                    schedule.location,
                    schedule.notes
                ].map(field => `"${field}"`).join(',');
                csvRows.push(row);
            }
            
            const csvContent = csvRows.join('\n');
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `research_center_schedule_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Enter í‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('inputText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                addSchedule();
            }
        });

        document.getElementById('queryText').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                querySchedule();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadSchedules();
            updateScheduleTable();
        });
    </script>
</body>
</html> 